# SWメニュー

## 概要

SWメニューは、SW（ソフトウェア）関連の**部品構成管理**および**流動数の確認・登録**を行うためのシステムです。

---

## 機能要件

### コア機能

| 機能 | 説明 |
|------|------|
| 構成表の確認 | 部品構成データの閲覧・検索 |
| 構成表の登録 | 新規部品構成データの追加・編集 |
| 流動数管理 | 在庫や流動数の確認・更新 |
| 品番管理 | 品番マスタの閲覧・検索・追加・編集 |

### UI/UX 仕様

- **表示領域**: クイックアクション起動時、Three.js 背景領域に表示を切り替え
- **デザインコンセプト**: 既存アプリケーションのUIを踏襲しつつ、RPGゲーム風のインタラクティブなデザイン
- **操作性**: 直感的なメニュー操作とアニメーション効果

---

## 技術仕様

### データベース接続

| 項目 | 値 |
|------|-----|
| DB種別 | MariaDB / MySQL |
| プロトコル | TCP/IP |
| ライブラリ | `libmariadb.dll` |
| ホスト | `192.168.0.156` |
| ポート | `3306` |
| ユーザー | `alluser` |
| データベース | `zoltraak` |

> ⚠️ **セキュリティ注意**: 接続パスワードは環境変数または設定ファイル（`.env`）で管理してください。

### 環境設定

- プロジェクトルートの `sw-menu.env` を自動で読み込みます（Electron起動時・初期化スクリプト共通）
- 既定値:

```
MARIADB_HOST=192.168.0.156
MARIADB_PORT=3306
MARIADB_USER=alluser
MARIADB_PASSWORD=wew111589
SW_DB_NAME=zoltraak
```

### 品番マスタ（テーブル設計案）

| カラム名 | 型 | 説明 |
|---------|-----|------|
| `part_id` | INT (PK) | 品番ID（自動採番） |
| `line` | VARCHAR(100) | ライン
| `part_number` | VARCHAR(50) | 品番コード（ユニーク） |
| `category` | VARCHAR(50) | カテゴリ / 分類 |
| `supplier` | VARCHAR(100) | 仕入先 |
| `remarks` | TEXT | 備考 |
| `created_at` | DATETIME | 登録日時 |
| `updated_at` | DATETIME | 更新日時 |

### 構成データ（テーブル設計案）

| カラム名 | 型 | 説明 |
|---------|-----|------|
| `id` | INT (PK) | レコードID（自動採番） |
| `parent_part_number` | VARCHAR(50) | 親品番（品番マスタの`part_number`を参照） |
| `child_part_number` | VARCHAR(50) | 構成品番（品番マスタの`part_number`を参照） |
| `quantity` | DECIMAL(10,3) | 使用量 |
| `remarks` | TEXT | 備考 |
| `created_at` | DATETIME | 登録日時 |
| `updated_at` | DATETIME | 更新日時 |

---

### CSV一括登録（品番）

- 画面の「品番データ > CSVで一括登録」からヘッダー付きCSVを読み込み、一括で品番マスタへ登録できます
- 必須: `部品コード` / `名称`、任意: `版数`・`場所`・`説明`
- サンプルヘッダー: `部品コード,名称,版数,場所,説明`
- 重複している品番コードは内容を上書きします。空行や必須項目が欠けた行はスキップされ、取り込み結果として表示されます

---

### スキーマ概要

- `sw_components`: 部品コード・名称・版数を管理
- `sw_boms`: 親子の部品構成と必要数、備考を管理
- `sw_flow_counts`: 部品ごとの流動数・場所・状態を管理

### 初期化手順

1. `.env` などで接続情報を設定する（例: `MARIADB_PASSWORD`、必要に応じて `MARIADB_HOST` / `MARIADB_USER` / `MARIADB_PORT`）
2. `npm run init-sw-db` を実行し、`zoltraak` データベースと上記テーブルを作成

---

## 今後の拡張予定

- [ ] 部品検索機能の強化
- [ ] レポート出力機能
- [ ] ユーザー権限管理
