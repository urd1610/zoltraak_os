<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>生産会議資料</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18?dev",
        "react-dom/client": "https://esm.sh/react-dom@18/client?dev",
        "lucide-react": "https://esm.sh/lucide-react@0.292.0?dev"
      }
    }
  </script>
  <style>
    @keyframes fade-in {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in {
      animation: fade-in 0.5s ease-out forwards;
    }
    /* スクロールバーのカスタマイズ */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    ::-webkit-scrollbar-track {
      background: #f1f5f9; 
    }
    ::-webkit-scrollbar-thumb {
      background: #cbd5e1; 
      border-radius: 3px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #94a3b8; 
    }
  </style>
</head>
<body class="bg-black m-0 p-0 overflow-hidden">
  <div id="root"></div>
  <script type="text/babel" data-type="module">
    import React, { useState, useEffect, useCallback } from 'react';
    import { createRoot } from 'react-dom/client';
    import { ChevronLeft, ChevronRight, BarChart3, Users, Truck, AlertTriangle, CheckCircle2, TrendingUp, Package, Factory, Calendar, Clock, ArrowRight } from 'lucide-react';

// --- コンポーネント定義 ---

// 共通レイアウトコンポーネント (調整: パディング縮小、ヘッダー高さ縮小)
const SlideLayout = ({ title, subTitle, children, slideNumber, totalSlides }) => (
  <div className="flex flex-col h-screen w-screen bg-slate-50 text-slate-800 font-sans relative overflow-hidden">
    {/* ヘッダー */}
    <div className="bg-slate-900 text-white px-6 py-3 flex justify-between items-center shadow-md shrink-0 h-20 z-20">
      <div>
        <h1 className="text-2xl font-bold tracking-wide">{title}</h1>
        {subTitle && <p className="text-slate-400 text-base mt-0.5">{subTitle}</p>}
      </div>
      <div className="flex items-center gap-2 opacity-80">
        <Factory size={24} />
        <span className="font-semibold tracking-wider text-lg">Shoei Denko</span>
      </div>
    </div>

    {/* メインコンテンツエリア (調整: パディング縮小) */}
    <div className="flex-grow p-6 overflow-hidden relative z-10">
      <div className="h-full w-full max-w-[1600px] mx-auto flex flex-col justify-center">
        {children}
      </div>
    </div>

    {/* フッター / 進行状況 (調整: 高さ縮小) */}
    <div className="bg-white border-t border-slate-200 px-6 h-14 shrink-0 flex justify-between items-center text-slate-500 text-sm z-20">
      <span>2026年1月度 生産会議</span>
      <div className="flex items-center gap-4">
        <span className="font-mono text-base">{slideNumber} / {totalSlides}</span>
        <div className="w-40 h-2 bg-slate-200 rounded-full overflow-hidden">
          <div 
            className="h-full bg-blue-600 transition-all duration-300"
            style={{ width: `${(slideNumber / totalSlides) * 100}%` }}
          />
        </div>
      </div>
    </div>
  </div>
);

// 1. 表紙 (調整: サイズ縮小)
const CoverSlide = () => (
  <div className="flex flex-col items-center justify-center h-full text-center space-y-8 animate-fade-in">
    <div className="bg-blue-100 p-8 rounded-full mb-4 ring-8 ring-blue-50">
      <Factory size={90} className="text-blue-700" />
    </div>
    <div>
      <h2 className="text-xl text-blue-600 font-bold tracking-widest mb-4">MONTHLY REPORT</h2>
      <h1 className="text-6xl font-extrabold text-slate-900 mb-6 tracking-tight">1月度 生産会議</h1>
      <div className="h-2 w-32 bg-blue-600 mx-auto mb-6 rounded-full"></div>
    </div>
    <div className="mt-12 text-slate-500 font-mono text-xl bg-white px-8 py-2 rounded-full border border-slate-200 shadow-sm">
      2026.01.07 (Wed)
    </div>
  </div>
);

// 2. アジェンダ (調整: 文字サイズ・ギャップ縮小)
const AgendaSlide = () => {
  const items = [
    "今月の受注状況", "生産計画 vs 生産実績", "部品調達状況", 
    "人員状況", "仕入先売上状況", "品質実績 (品質報告)", "総合評価 (リスクと対策)"
  ];
  return (
    <div className="grid grid-cols-1 md:grid-cols-2 gap-12 items-center h-full max-w-6xl mx-auto">
      <div className="space-y-6">
        <h3 className="text-4xl font-bold text-slate-800 border-l-[10px] border-blue-600 pl-8 py-3 leading-tight">
          本日の<br/>議題
        </h3>
        <p className="text-slate-500 pl-10 text-xl leading-relaxed">
          今月の生産活動の振り返りと<br/>来月以降の課題対策について
        </p>
      </div>
      <div className="bg-white p-10 rounded-3xl shadow-xl border border-slate-100">
        <ul className="space-y-4">
          {items.map((item, idx) => (
            <li key={idx} className="flex items-center text-xl text-slate-700 p-3 hover:bg-blue-50 rounded-xl transition-colors cursor-default group">
              <span className="flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-700 rounded-full font-bold mr-5 text-base group-hover:bg-blue-600 group-hover:text-white transition-colors">
                {idx + 1}
              </span>
              <span className="group-hover:translate-x-2 transition-transform font-medium">{item}</span>
            </li>
          ))}
        </ul>
      </div>
    </div>
  );
};

// 3. 今月の受注状況 (調整: テーブル・グラフサイズ最適化)
const OrdersSlide = () => {
  const loadTrend = [
    { month: '4月', switch: 2100, cord: 4800 },
    { month: '5月', switch: 2050, cord: 4700 },
    { month: '6月', switch: 2200, cord: 4900 },
    { month: '7月', switch: 2300, cord: 5100 },
    { month: '8月', switch: 1900, cord: 4500 }, 
    { month: '9月', switch: 2400, cord: 5300 },
    { month: '10月', switch: 2500, cord: 5400 },
    { month: '11月', switch: 2600, cord: 5500 },
    { month: '12月', switch: 2300, cord: 5000 }, 
    { month: '1月', switch: 2400, cord: 5200, isCurrent: true },
    { month: '2月', switch: 2650, cord: 5800 },
    { month: '3月', switch: 3100, cord: 6500, isPeak: true },
  ];

  const orderTrend = [
    { month: '4', value: 115 },
    { month: '5', value: 112 },
    { month: '6', value: 120 },
    { month: '7', value: 125 },
    { month: '8', value: 105 },
    { month: '9', value: 122 },
    { month: '10', value: 126 },
    { month: '11', value: 128 },
    { month: '12', value: 118 },
    { month: '1', value: 128.5, isCurrent: true },
    { month: '2', value: 132.0 },
    { month: '3', value: 145.0 },
  ];

  const width = 480;
  const height = 160;
  const padding = { top: 20, bottom: 25, left: 20, right: 20 };
  const graphWidth = width - (padding.left + padding.right);
  const graphHeight = height - (padding.top + padding.bottom);
  const maxVal = 7000;

  const getX = (index) => padding.left + (index * (graphWidth / (loadTrend.length - 1)));
  const getY = (value) => height - padding.bottom - ((value / maxVal) * graphHeight);

  const switchPoints = loadTrend.map((d, i) => `${getX(i)},${getY(d.switch)}`).join(' ');
  const cordPoints = loadTrend.map((d, i) => `${getX(i)},${getY(d.cord)}`).join(' ');

  const sWidth = 480;
  const sHeight = 80;
  const sMax = 150;
  const sMin = 90; 
  const getSX = (index) => (index * (sWidth / (orderTrend.length - 1)));
  const getSY = (value) => sHeight - ((value - sMin) / (sMax - sMin) * sHeight);
  
  const areaPath = `M0,${sHeight} ` + orderTrend.map((d, i) => `L${getSX(i)},${getSY(d.value)}`).join(' ') + ` L${sWidth},${sHeight} Z`;
  const linePath = orderTrend.map((d, i) => `${i===0?'M':'L'}${getSX(i)},${getSY(d.value)}`).join(' ');

  return (
    <div className="grid grid-cols-2 grid-rows-2 gap-6 h-full">
      {/* 1. 当月・次月の受注状況 */}
      <div className="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm flex flex-col relative overflow-hidden group hover:shadow-md transition-shadow">
        <h3 className="text-xl font-bold text-slate-800 mb-2 flex items-center gap-2 relative z-10">
          <TrendingUp className="text-blue-600" size={24}/> 受注状況サマリ
        </h3>
        <table className="w-full text-left text-base relative z-10 mb-2">
          <thead className="text-slate-500 border-b border-slate-100">
            <tr>
              <th className="p-2 pl-2 font-normal">期間</th>
              <th className="p-2 font-normal">金額 (百万円)</th>
              <th className="p-2 font-normal">計画比</th>
              <th className="p-2 font-normal">前月比</th>
            </tr>
          </thead>
          <tbody className="divide-y divide-slate-50">
            <tr className="group/row">
              <td className="p-2 pl-2 font-bold text-slate-700">当月 (確定)</td>
              <td className="p-2 text-2xl font-bold text-slate-800">128.5</td>
              <td className="p-2 text-emerald-600 font-bold bg-emerald-50/50 rounded text-lg">+5.2%</td>
              <td className="p-2 text-blue-600 font-bold text-lg">+105%</td>
            </tr>
            <tr className="group/row">
              <td className="p-2 pl-2 font-bold text-slate-500">次月 (見込)</td>
              <td className="p-2 text-2xl font-bold text-slate-600">132.0</td>
              <td className="p-2 text-emerald-600 font-bold text-lg">+2.1%</td>
              <td className="p-2 text-blue-600 font-bold text-lg">+102%</td>
            </tr>
          </tbody>
        </table>

        {/* 追加: 受注金額推移 */}
        <div className="flex-grow flex flex-col justify-end mt-1 px-2">
          <div className="text-xs text-blue-500 font-bold mb-1 text-center opacity-80">
             推移 (12ヶ月)
          </div>
          <div className="w-full h-16 relative mb-1">
            <svg viewBox={`0 0 ${sWidth} ${sHeight}`} className="w-full h-full overflow-visible" preserveAspectRatio="none">
              <defs>
                <linearGradient id="orderGradient" x1="0" y1="0" x2="0" y2="1">
                  <stop offset="0%" stopColor="#3b82f6" stopOpacity="0.2"/>
                  <stop offset="100%" stopColor="#3b82f6" stopOpacity="0"/>
                </linearGradient>
              </defs>
              <path d={areaPath} fill="url(#orderGradient)" />
              <path d={linePath} fill="none" stroke="#3b82f6" strokeWidth="2.5" vectorEffect="non-scaling-stroke" />
              {orderTrend.map((d, i) => (
                <g key={i}>
                  {d.isCurrent && (
                     <circle cx={getSX(i)} cy={getSY(d.value)} r="3.5" fill="#3b82f6" stroke="white" strokeWidth="2" />
                  )}
                </g>
              ))}
            </svg>
          </div>
          <div className="relative w-full h-4">
             {orderTrend.map((d, i) => (
               <div 
                 key={i} 
                 className={`absolute top-0 -translate-x-1/2 text-[10px] text-center whitespace-nowrap ${d.isCurrent ? 'font-bold text-blue-600 text-xs' : 'text-slate-400'}`}
                 style={{ left: `${(i / (orderTrend.length - 1)) * 100}%` }}
               >
                  {d.month}
               </div>
             ))}
          </div>
        </div>
      </div>

      {/* 2. 顧客別受注構成 */}
      <div className="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm flex flex-col group hover:shadow-md transition-shadow">
        <h3 className="text-xl font-bold text-slate-800 mb-2 flex items-center gap-2">
          <Users className="text-blue-600" size={24}/> 顧客別受注構成
        </h3>
        <div className="flex items-center justify-center gap-8 flex-grow">
          <div className="relative w-44 h-44 rounded-full shadow-sm shrink-0 transition-transform group-hover:scale-105 duration-500"
               style={{
                 background: `conic-gradient(
                   #3b82f6 0% 45%, 
                   #10b981 45% 75%, 
                   #f59e0b 75% 90%, 
                   #94a3b8 90% 100%
                 )`
               }}>
             <div className="absolute inset-0 m-auto w-32 h-32 bg-white rounded-full flex items-center justify-center shadow-inner">
               <span className="text-sm text-slate-400 font-bold text-center leading-tight">Total<br/><span className="text-slate-800 text-3xl font-extrabold">100%</span></span>
             </div>
          </div>
          <ul className="text-base space-y-3">
            <li className="flex items-center gap-2"><span className="w-3 h-3 rounded-full bg-blue-500 shadow-sm"></span> 自動車関連 A社 <span className="font-bold text-slate-700 text-lg ml-auto">(45%)</span></li>
            <li className="flex items-center gap-2"><span className="w-3 h-3 rounded-full bg-emerald-500 shadow-sm"></span> 建機メーカー B社 <span className="font-bold text-slate-700 text-lg ml-auto">(30%)</span></li>
            <li className="flex items-center gap-2"><span className="w-3 h-3 rounded-full bg-amber-500 shadow-sm"></span> 電機部品 C社 <span className="font-bold text-slate-700 text-lg ml-auto">(15%)</span></li>
            <li className="flex items-center gap-2"><span className="w-3 h-3 rounded-full bg-slate-400 shadow-sm"></span> その他 <span className="font-bold text-slate-700 text-lg ml-auto">(10%)</span></li>
          </ul>
        </div>
      </div>

      {/* 3. 受注変更の主な要因 */}
      <div className="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm group hover:shadow-md transition-shadow">
        <h3 className="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
          <AlertTriangle className="text-orange-500" size={24}/> 受注変動要因
        </h3>
        <ul className="space-y-3">
          {[
            { title: "A社 新型車向け増産", desc: "SUVモデル好調につき、予定より20%上振れ。", type: "positive" },
            { title: "B社 在庫調整による減", desc: "海外輸出停滞の影響で一時的に発注抑制。", type: "negative" },
            { title: "スポット案件の受注", desc: "短納期の試作案件を受注 (売上寄与 +300万)。", type: "positive" }
          ].map((item, i) => (
            <li key={i} className="bg-slate-50 p-4 rounded-xl border-l-8 border-slate-300 flex justify-between items-start hover:bg-slate-100 transition-colors">
              <div>
                <div className="font-bold text-slate-700 text-lg mb-1">{item.title}</div>
                <div className="text-sm text-slate-500">{item.desc}</div>
              </div>
              <span className={`text-sm font-bold px-2 py-1 rounded-md mt-1 shrink-0 ${
                item.type === 'positive' ? 'bg-blue-100 text-blue-700' : 'bg-red-100 text-red-700'
              }`}>
                {item.type === 'positive' ? '増' : '減'}
              </span>
            </li>
          ))}
        </ul>
      </div>

      {/* 4. 組立加工 月別日当たり負荷グラフ */}
      <div className="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm flex flex-col group hover:shadow-md transition-shadow">
        <h3 className="text-xl font-bold text-slate-800 mb-2 flex items-center justify-between">
          <span className="flex items-center gap-2"><BarChart3 className="text-indigo-600" size={24}/> 組立加工 負荷推移 (12ヶ月)</span>
          <span className="text-xs font-normal text-slate-500 bg-slate-100 px-2 py-1 rounded">2025/4 〜 2026/3</span>
        </h3>
        
        <div className="flex-grow flex flex-col justify-end relative w-full h-full">
          <div className="w-full h-full relative">
            <svg viewBox={`0 0 ${width} ${height}`} className="w-full h-full overflow-visible">
              {[0, 2000, 4000, 6000].map(val => (
                <g key={val}>
                  <line x1="0" y1={getY(val)} x2={width} y2={getY(val)} stroke="#e2e8f0" strokeWidth="1" strokeDasharray="4 4" />
                  <text x="-8" y={getY(val)} textAnchor="end" alignmentBaseline="middle" className="text-[10px] fill-slate-400">{val}</text>
                </g>
              ))}
              <rect x={getX(9) - (graphWidth/(loadTrend.length-1))/2} y="0" width={graphWidth/(loadTrend.length-1)} height={height - padding.bottom} fill="#eff6ff" />
              <polyline points={cordPoints} fill="none" stroke="#10b981" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" />
              <polyline points={switchPoints} fill="none" stroke="#3b82f6" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" />
              {loadTrend.map((d, i) => (
                <g key={i}>
                  <circle cx={getX(i)} cy={getY(d.switch)} r="4" fill="white" stroke="#3b82f6" strokeWidth="2" className="hover:r-6 transition-all cursor-pointer">
                    <title>{`${d.month}: Switch ${d.switch}個`}</title>
                  </circle>
                  <circle cx={getX(i)} cy={getY(d.cord)} r="4" fill="white" stroke="#10b981" strokeWidth="2" className="hover:r-6 transition-all cursor-pointer">
                    <title>{`${d.month}: Cord ${d.cord}個`}</title>
                  </circle>
                  <text x={getX(i)} y={height} textAnchor="middle" className={`text-[10px] ${d.isCurrent ? 'font-bold fill-blue-700 text-xs' : 'fill-slate-500'}`}>
                    {d.month}
                  </text>
                  {d.isPeak && (
                    <g>
                        <rect x={getX(i)-14} y={getY(d.cord)-28} width="28" height="16" rx="3" fill="#ef4444" />
                        <text x={getX(i)} y={getY(d.cord) - 17} textAnchor="middle" className="text-[9px] fill-white font-bold">繁忙</text>
                    </g>
                  )}
                </g>
              ))}
            </svg>
          </div>
        </div>
        
        <div className="flex justify-center gap-8 text-sm text-slate-600 mt-2 pt-2 border-t border-slate-100">
            <div className="flex items-center gap-2">
              <div className="w-10 h-1.5 bg-blue-500 rounded-full"></div> 
              スイッチ <span className="text-xs text-slate-400">(個/日)</span>
            </div>
            <div className="flex items-center gap-2">
              <div className="w-10 h-1.5 bg-emerald-500 rounded-full"></div> 
              コード <span className="text-xs text-slate-400">(個/日)</span>
            </div>
        </div>
      </div>
    </div>
  );
};

// 4. 生産計画 vs 実績 (調整: ギャップ縮小、フォント最適化)
const ProductionSlide = () => {
  const tableData = [
    { category: 'スイッチ', month: '12月 (前月)', plan: 20000, act: 19850, diff: '-0.7%', delivery: '96.5%' },
    { category: 'スイッチ', month: '1月 (当月)', plan: 22000, act: '-', diff: '-', delivery: '-' },
    { category: 'コード', month: '12月 (前月)', plan: 45000, act: 45200, diff: '+0.4%', delivery: '99.2%' },
    { category: 'コード', month: '1月 (当月)', plan: 48000, act: '-', diff: '-', delivery: '-' },
  ];

  const delayReasons = [
    { rank: 1, title: "部材入荷遅延", desc: "コネクタ部品(CN-2)の納入が2日遅れ、ライン投入待ちが発生。" },
    { rank: 2, title: "設備チョコ停", desc: "第2加工機のセンサー誤検知により、断続的な停止時間が発生。" },
    { rank: 3, title: "人員不足", desc: "特定工程の熟練者欠勤により、サイクルタイムが低下。" },
  ];

  const chartData = [
    { name: 'スイッチ (前月)', plan: 20000, act: 19850, max: 25000 },
    { name: 'コード (前月)', plan: 45000, act: 45200, max: 50000 },
  ];

  return (
    <div className="flex flex-col h-full gap-6">
      {/* 上段エリア */}
      <div className="grid grid-cols-5 gap-6 h-1/2">
        {/* 左: 予実比較グラフ */}
        <div className="col-span-3 bg-white p-6 rounded-2xl border border-slate-200 shadow-sm flex flex-col group hover:shadow-md transition-shadow">
          <h3 className="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
            <BarChart3 className="text-blue-600" size={24}/> 生産予実比較 (前月実績)
          </h3>
          <div className="flex-grow flex justify-around items-end px-8 pb-4">
             {chartData.map((d, i) => (
               <div key={i} className="flex flex-col items-center gap-2 w-1/3 h-full justify-end">
                 <div className="flex gap-4 items-end justify-center w-full h-full pb-3 border-b border-slate-200">
                   {/* Plan Bar */}
                   <div className="w-16 bg-slate-200 rounded-t-lg relative group/bar flex items-end justify-center hover:bg-slate-300 transition-colors" style={{height: `${(d.plan/d.max)*100}%`}}>
                     <span className="absolute -top-10 text-xs font-bold text-slate-600 text-center leading-tight">計画<br/><span className="text-base">{(d.plan/1000).toFixed(1)}k</span></span>
                   </div>
                   {/* Act Bar */}
                   <div className={`w-16 rounded-t-lg relative group/bar flex items-end justify-center ${d.act >= d.plan ? 'bg-blue-600 hover:bg-blue-700' : 'bg-red-500 hover:bg-red-600'} transition-colors shadow-sm`} style={{height: `${(d.act/d.max)*100}%`}}>
                     <span className="absolute -top-10 text-xs font-bold text-slate-700 text-center leading-tight z-10">実績<br/><span className="text-base">{(d.act/1000).toFixed(1)}k</span></span>
                   </div>
                 </div>
                 <div className="font-bold text-slate-700 text-base mt-2">{d.name}</div>
               </div>
             ))}
             {/* 凡例 */}
             <div className="flex flex-col justify-center gap-3 mb-6 ml-4 p-3 bg-slate-50 rounded-xl border border-slate-100">
                <div className="flex items-center gap-2 text-xs text-slate-700"><div className="w-4 h-4 bg-slate-200 rounded-md"></div> 計画</div>
                <div className="flex items-center gap-2 text-xs text-slate-700"><div className="w-4 h-4 bg-blue-600 rounded-md"></div> 実績(達)</div>
                <div className="flex items-center gap-2 text-xs text-slate-700"><div className="w-4 h-4 bg-red-500 rounded-md"></div> 実績(未)</div>
             </div>
          </div>
        </div>

        {/* 右: 未達原因トップ3 */}
        <div className="col-span-2 bg-white p-6 rounded-2xl border border-slate-200 shadow-sm flex flex-col group hover:shadow-md transition-shadow">
          <h3 className="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
            <AlertTriangle className="text-orange-500" size={24}/> 納期遵守率 未達要因
          </h3>
          <div className="flex-grow flex flex-col justify-center gap-4">
            {delayReasons.map((r) => (
              <div key={r.rank} className="flex gap-3 items-start p-3 bg-slate-50 rounded-xl border border-slate-100 hover:bg-orange-50/50 transition-colors">
                <div className="flex-shrink-0 w-8 h-8 flex items-center justify-center bg-orange-100 text-orange-600 font-bold text-base rounded-full shadow-sm">
                  {r.rank}
                </div>
                <div>
                  <div className="font-bold text-slate-700 text-base mb-1">{r.title}</div>
                  <div className="text-sm text-slate-600 leading-normal">{r.desc}</div>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>

      {/* 下段: 詳細テーブル */}
      <div className="h-1/2 bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden flex flex-col group hover:shadow-md transition-shadow">
        <h3 className="text-xl font-bold text-slate-800 p-5 pb-2 flex items-center gap-2">
           <Calendar className="text-emerald-600" size={24}/> 生産実績詳細データ
        </h3>
        <div className="p-5 overflow-auto">
          <table className="w-full text-left border-collapse">
            <thead className="bg-slate-100 text-slate-700 text-sm">
              <tr>
                <th className="p-3 border-b border-slate-200 rounded-tl-lg">品目</th>
                <th className="p-3 border-b border-slate-200">対象月</th>
                <th className="p-3 border-b border-slate-200 text-right">計画数</th>
                <th className="p-3 border-b border-slate-200 text-right">実績数</th>
                <th className="p-3 border-b border-slate-200 text-right">差異率</th>
                <th className="p-3 border-b border-slate-200 text-right rounded-tr-lg">納期遵守率</th>
              </tr>
            </thead>
            <tbody className="text-base">
              {tableData.map((row, i) => (
                <tr key={i} className="hover:bg-slate-50 border-b border-slate-50 last:border-0 transition-colors">
                  <td className={`p-3 font-bold ${row.category === 'スイッチ' ? 'text-blue-700' : 'text-emerald-700'}`}>{row.category}</td>
                  <td className="p-3 text-slate-600">{row.month}</td>
                  <td className="p-3 text-right font-medium text-slate-700">{row.plan.toLocaleString()}</td>
                  <td className="p-3 text-right text-slate-600">{typeof row.act === 'number' ? row.act.toLocaleString() : row.act}</td>
                  <td className={`p-3 text-right font-bold ${row.diff.startsWith('-') ? 'text-red-500' : row.diff === '-' ? 'text-slate-400' : 'text-blue-500'}`}>{row.diff}</td>
                  <td className={`p-3 text-right font-bold ${row.delivery === '-' ? 'text-slate-400' : parseFloat(row.delivery) < 97 ? 'text-red-500' : 'text-emerald-600'}`}>{row.delivery}</td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  );
};

// 5. 部品調達状況 (調整: フォントサイズ縮小)
const ProcurementSlide = () => (
  <div className="flex flex-col h-full gap-6">
    <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 group hover:shadow-md transition-shadow">
      <h3 className="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
        <Truck className="text-blue-600" size={24}/> 納期遵守率
      </h3>
      <div className="grid grid-cols-3 gap-8 divide-x divide-slate-100">
        <div className="text-center">
           <div className="text-sm text-slate-500 mb-1">全体</div>
           <div className="text-4xl font-bold text-slate-800">98.5<span className="text-xl text-slate-500">%</span></div>
           <div className="text-sm text-emerald-600 mt-1 font-bold bg-emerald-50 inline-block px-3 py-1 rounded">目標達成</div>
        </div>
        <div className="text-center">
           <div className="text-sm text-slate-500 mb-1">製品別 (主要3製品)</div>
           <div className="text-4xl font-bold text-blue-600">99.2<span className="text-xl text-slate-500">%</span></div>
           <div className="text-sm text-slate-400 mt-1">前月比 +0.2pt</div>
        </div>
        <div className="text-center">
           <div className="text-sm text-slate-500 mb-1">工程別 (加工・組立)</div>
           <div className="text-4xl font-bold text-yellow-600">96.8<span className="text-xl text-slate-500">%</span></div>
           <div className="text-sm text-red-500 mt-1 font-bold">外注加工にて遅延あり</div>
        </div>
      </div>
    </div>

    <div className="grid grid-cols-2 gap-6 flex-grow">
        {/* 左下: 欠品・遅延発生状況 */}
        <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 flex flex-col group hover:shadow-md transition-shadow">
           <div className="flex justify-between items-start mb-4">
              <h3 className="text-xl font-bold text-slate-800 flex items-center gap-2">
                <AlertTriangle className="text-red-500" size={24}/> 欠品・遅延・過多状況
              </h3>
              <div className="bg-red-50 px-4 py-2 rounded-xl border border-red-100 text-center animate-pulse">
                 <div className="text-xs text-red-500 font-bold mb-1">発生件数</div>
                 <div className="text-2xl font-bold text-red-600 leading-none">3<span className="text-sm">件</span></div>
              </div>
           </div>
           
           <div className="space-y-4 flex-grow">
              <div className="bg-slate-50 p-4 rounded-xl border border-slate-100 hover:bg-orange-50/50 transition-colors">
                 <div className="text-xs font-bold text-slate-500 mb-2 flex items-center gap-2"><Package size={14}/> 在庫過多アラート</div>
                 <div className="flex justify-between items-center mb-1">
                    <span className="text-base font-bold text-slate-800">板金筐体パーツ (L-22)</span>
                    <span className="text-xs bg-orange-100 text-orange-700 px-2 py-0.5 rounded font-bold">1.5ヶ月分超過</span>
                 </div>
                 <p className="text-xs text-slate-600">※ 新製品切り替えに伴う旧部品の滞留。来月より発注停止。</p>
              </div>

               <div className="bg-slate-50 p-4 rounded-xl border border-slate-100 hover:bg-yellow-50/50 transition-colors">
                 <div className="text-xs font-bold text-slate-500 mb-2 flex items-center gap-2"><TrendingUp size={14}/> 価格高騰リスク</div>
                 <div className="flex justify-between items-center mb-1">
                    <span className="text-base font-bold text-slate-800">銅・真鍮素材</span>
                    <span className="text-xs bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded font-bold">単価 +15%</span>
                 </div>
                 <p className="text-xs text-slate-600">※ 3月入荷分より適用予定。原価低減活動が必要。</p>
              </div>
           </div>
        </div>

        {/* 右下: リスクタイムライン */}
        <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 flex flex-col group hover:shadow-md transition-shadow">
           <h3 className="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
              <Calendar className="text-indigo-600" size={24}/> リスク予測タイムライン
           </h3>
           <div className="space-y-0 relative border-l-4 border-slate-200 ml-3 pl-6 pb-2">
              <div className="mb-6 relative">
                 <div className="absolute -left-[35px] top-1.5 w-5 h-5 rounded-full bg-red-500 border-4 border-white shadow-sm ring-2 ring-red-100"></div>
                 <h4 className="font-bold text-red-600 text-base mb-1">当月 (1月)のリスク</h4>
                 <div className="bg-red-50 p-3 rounded-xl border border-red-100 hover:shadow-sm transition-shadow">
                    <div className="font-bold text-slate-800 text-sm">コネクタ (CN-204) 納期遅延</div>
                    <p className="text-slate-700 text-xs mt-1">海外港湾ストライキの影響。20日入荷予定→25日にずれ込み。組立工程の調整で吸収可能。</p>
                 </div>
              </div>
              
              <div className="mb-6 relative">
                 <div className="absolute -left-[35px] top-1.5 w-5 h-5 rounded-full bg-yellow-400 border-4 border-white shadow-sm ring-2 ring-yellow-100"></div>
                 <h4 className="font-bold text-yellow-700 text-base mb-1">翌月 (2月)のリスク</h4>
                 <div className="bg-yellow-50 p-3 rounded-xl border border-yellow-100 hover:shadow-sm transition-shadow">
                    <div className="font-bold text-slate-800 text-sm">ICチップ (X-Series) 供給不安</div>
                    <p className="text-slate-700 text-xs mt-1">メーカー生産枠縮小の通達あり。市場流通在庫の確保へ動く必要あり。</p>
                 </div>
              </div>

              <div className="relative">
                 <div className="absolute -left-[35px] top-1.5 w-5 h-5 rounded-full bg-blue-300 border-4 border-white shadow-sm ring-2 ring-blue-100"></div>
                 <h4 className="font-bold text-blue-600 text-base mb-1">3月以降の課題</h4>
                 <p className="text-sm text-slate-700 leading-relaxed">
                    4月の新製品量産開始に向けた専用部材(金型品)のトライが3月上旬。品質承認の遅れが量産開始に直結するため、進捗管理を強化する。
                 </p>
              </div>
           </div>
        </div>
    </div>
  </div>
);

// 6. 人員状況 (調整: テーブル・文字サイズ)
const PersonnelSlide = () => {
  const data = {
    months: ['12月 (実績)', '1月 (当月)', '2月 (翌月)'],
    switch: [
      { month: 0, load: 92.5, headcount: 12, capacity: 96.0, balance: 3.5 },
      { month: 1, load: 105.0, headcount: 12, capacity: 96.0, balance: -9.0 },
      { month: 2, load: 115.0, headcount: 13, capacity: 104.0, balance: -11.0 }, 
    ],
    cord: [
      { month: 0, load: 160.0, headcount: 20, capacity: 160.0, balance: 0 },
      { month: 1, load: 155.0, headcount: 20, capacity: 160.0, balance: 5.0 },
      { month: 2, load: 170.0, headcount: 20, capacity: 160.0, balance: -10.0 },
    ]
  };

  const renderCells = (sectionData, field) => (
     sectionData.map((d, i) => (
        <td key={i} className={`p-3 text-right text-base border-b border-slate-100 ${i===1 ? 'bg-blue-50/50' : ''}`}>
           {field === 'balance' ? (
              <span className={`font-bold px-2 py-1 rounded ${d[field] < 0 ? 'bg-red-100 text-red-600' : 'bg-blue-100 text-blue-600'}`}>
                 {d[field] > 0 ? '+' : ''}{Number.isInteger(d[field]) ? d[field] : d[field].toFixed(1)}
              </span>
           ) : field === 'headcount' ? (
              <span className="text-slate-700 font-bold">{d[field]}</span>
           ) : (
              <span className="text-slate-600">{Number.isInteger(d[field]) ? d[field] : d[field].toFixed(1)}</span>
           )}
        </td>
     ))
  );

  return (
    <div className="flex flex-col h-full gap-6">
       <div className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden flex-grow flex flex-col group hover:shadow-md transition-shadow">
          <div className="p-4 bg-slate-50 border-b border-slate-200 flex justify-between items-center">
             <h3 className="text-xl font-bold text-slate-800 flex items-center gap-2">
               <Users className="text-blue-600" size={24}/> 工数・人員需給バランス表 (日当たり換算)
             </h3>
             <div className="flex gap-4 text-sm">
                <span className="flex items-center gap-2"><div className="w-4 h-4 bg-blue-100 rounded-sm"></div> 余裕あり</span>
                <span className="flex items-center gap-2"><div className="w-4 h-4 bg-red-100 rounded-sm"></div> 人員不足</span>
             </div>
          </div>
          
          <div className="p-0 overflow-auto flex-grow">
             <table className="w-full text-left border-collapse">
                <thead className="bg-slate-100 text-slate-700 text-sm">
                   <tr>
                      <th className="p-3 pl-6 w-56 border-b border-slate-200">区分 / 項目</th>
                      {data.months.map((m, i) => (
                        <th key={i} className={`p-3 text-right w-32 border-b border-slate-200 ${i===1 ? 'bg-blue-50 text-blue-800 font-bold border-t-4 border-t-blue-500' : ''}`}>{m}</th>
                      ))}
                   </tr>
                </thead>
                <tbody>
                   <tr className="bg-slate-50">
                      <td colSpan="4" className="p-2 pl-6 text-sm font-bold text-slate-700 flex items-center gap-2 border-b border-slate-200">
                         <div className="w-1.5 h-5 bg-blue-500 rounded-full"></div> スイッチ組立
                      </td>
                   </tr>
                   <tr><td className="p-3 pl-8 text-sm text-slate-500 border-b border-slate-100">負荷時間 (h/日)</td>{renderCells(data.switch, 'load')}</tr>
                   <tr><td className="p-3 pl-8 text-sm text-slate-500 border-b border-slate-100">人員数 (名)</td>{renderCells(data.switch, 'headcount')}</tr>
                   <tr><td className="p-3 pl-8 text-sm text-slate-500 border-b border-slate-100">手持ち工数 (h/日)</td>{renderCells(data.switch, 'capacity')}</tr>
                   <tr><td className="p-3 pl-8 text-sm font-bold text-slate-700 border-b border-slate-200">過不足時間 (h/日)</td>{renderCells(data.switch, 'balance')}</tr>

                   <tr className="bg-slate-50">
                      <td colSpan="4" className="p-2 pl-6 text-sm font-bold text-slate-700 flex items-center gap-2 border-b border-slate-200">
                         <div className="w-1.5 h-5 bg-emerald-500 rounded-full"></div> コード加工
                      </td>
                   </tr>
                   <tr><td className="p-3 pl-8 text-sm text-slate-500 border-b border-slate-100">負荷時間 (h/日)</td>{renderCells(data.cord, 'load')}</tr>
                   <tr><td className="p-3 pl-8 text-sm text-slate-500 border-b border-slate-100">人員数 (名)</td>{renderCells(data.cord, 'headcount')}</tr>
                   <tr><td className="p-3 pl-8 text-sm text-slate-500 border-b border-slate-100">手持ち工数 (h/日)</td>{renderCells(data.cord, 'capacity')}</tr>
                   <tr><td className="p-3 pl-8 text-sm font-bold text-slate-700 border-b border-slate-200">過不足時間 (h/日)</td>{renderCells(data.cord, 'balance')}</tr>
                </tbody>
             </table>
          </div>
          
           <div className="p-4 bg-orange-50 border-t border-orange-100 text-sm flex gap-4 items-start shrink-0">
              <div className="flex items-center gap-2 font-bold text-orange-800 shrink-0 mt-0.5 text-base">
                 <AlertTriangle size={20}/> 要対策:
              </div>
              <ul className="text-slate-800 space-y-1 list-disc pl-5">
                 <li><strong>スイッチ (1月):</strong> 日当たり9.0hの不足。残業(1.0h/日/人)でカバーしつつ、一部を休日出勤(1回)で対応。</li>
                 <li><strong>スイッチ (2月):</strong> 増産により日当たり11.0h不足予測。増員(1名)に加え、他工程からの応援体制を構築する。</li>
                 <li><strong>コード (2月):</strong> 繁忙期により日当たり10.0h不足。1月中の前倒し生産在庫を活用し平準化を図る。</li>
              </ul>
           </div>
       </div>
    </div>
  );
};

// 7. 仕入先売上状況 (調整: パディング・文字サイズ)
const SupplierSlide = () => {
  const months = ['4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月', '1月', '2月', '3月'];
  const supplierData = [
    { name: '共栄電子', color: '#3b82f6', desc: '増額傾向 (新製品A 筐体量産)', data: [42, 45, 48, 50, 45, 55, 58, 62, 60, 65, 70, 75] },
    { name: 'スギヤマ電子', color: '#10b981', desc: '横ばい (電子部品・基板)', data: [35, 36, 34, 35, 32, 35, 36, 35, 34, 35, 35, 36] },
    { name: '北斗総業', color: '#f59e0b', desc: '減額傾向 (在庫調整中)', data: [22, 20, 19, 18, 15, 18, 17, 16, 15, 14, 13, 12] }
  ];

  const width = 800;
  const height = 300;
  const padding = { top: 30, bottom: 30, left: 40, right: 30 };
  const graphWidth = width - (padding.left + padding.right);
  const graphHeight = height - (padding.top + padding.bottom);
  const maxVal = 80;

  const getX = (index) => padding.left + (index * (graphWidth / (months.length - 1)));
  const getY = (value) => height - padding.bottom - ((value / maxVal) * graphHeight);
  const createPath = (dataPoints) => dataPoints.map((val, i) => `${i===0?'M':'L'}${getX(i)},${getY(val)}`).join(' ');

  return (
    <div className="flex flex-col h-full gap-6">
      <div className="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm flex-grow flex flex-col group hover:shadow-md transition-shadow">
        <div className="flex justify-between items-start mb-6">
           <h3 className="text-xl font-bold text-slate-800 flex items-center gap-2">
             <BarChart3 className="text-blue-600" size={24}/> 主要仕入先3社 売上推移 (12ヶ月)
           </h3>
           <div className="flex gap-8">
              {supplierData.map((sup, i) => (
                <div key={i} className="flex flex-col items-end">
                   <div className="flex items-center gap-2 text-base font-bold text-slate-700">
                      <div className="w-3 h-3 rounded-full shadow-sm" style={{backgroundColor: sup.color}}></div>
                      {sup.name}
                   </div>
                   <div className="text-xs text-slate-500">{sup.desc}</div>
                </div>
              ))}
           </div>
        </div>

        <div className="flex-grow w-full h-full relative">
           <svg viewBox={`0 0 ${width} ${height}`} className="w-full h-full overflow-visible">
              {[0, 20, 40, 60, 80].map((val) => (
                 <g key={val}>
                    <line x1={padding.left} y1={getY(val)} x2={width - padding.right} y2={getY(val)} stroke="#e2e8f0" strokeWidth="1" />
                    <text x={padding.left - 10} y={getY(val)} textAnchor="end" alignmentBaseline="middle" className="text-xs fill-slate-400">{val}</text>
                 </g>
              ))}
              <rect x={getX(9) - (graphWidth/(months.length-1))/2} y={padding.top} width={graphWidth/(months.length-1)} height={graphHeight} fill="#eff6ff" />
              <text x={getX(9)} y={padding.top - 10} textAnchor="middle" className="text-xs font-bold fill-blue-600">当月</text>
              {supplierData.map((sup, i) => (
                 <g key={i}>
                    <path d={createPath(sup.data)} fill="none" stroke={sup.color} strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" />
                    {sup.data.map((val, idx) => (
                       <circle 
                         key={idx}
                         cx={getX(idx)} 
                         cy={getY(val)} 
                         r="4" 
                         fill="white" 
                         stroke={sup.color} 
                         strokeWidth="2" 
                         className="hover:r-6 transition-all cursor-pointer"
                       >
                         <title>{`${months[idx]}: ${val}百万円`}</title>
                       </circle>
                    ))}
                 </g>
              ))}
              {months.map((m, i) => (
                 <text key={i} x={getX(i)} y={height - 8} textAnchor="middle" className={`text-xs ${i===9 ? 'font-bold fill-blue-600 text-sm' : 'fill-slate-500'}`}>
                    {m}
                 </text>
              ))}
           </svg>
        </div>
        <div className="text-right text-xs text-slate-400 mt-2">単位: 百万円</div>
      </div>
    </div>
  );
};

// 8. 品質実績 (調整: 文字サイズ縮小)
const QualitySlide = () => (
  <div className="space-y-6">
     <div className="flex gap-6">
        <div className="w-1/3 bg-white p-6 rounded-2xl border border-slate-200 shadow-sm text-center group hover:shadow-md transition-shadow">
           <h4 className="text-slate-500 mb-2 text-base">工程内不良率</h4>
           <div className="text-5xl font-bold text-blue-600 mb-2">0.32<span className="text-2xl">%</span></div>
           <p className="text-base text-green-600 flex justify-center items-center gap-1 font-bold">
             <CheckCircle2 size={20} /> 目標 0.5%以下 達成
           </p>
        </div>
        <div className="w-1/3 bg-white p-6 rounded-2xl border border-slate-200 shadow-sm text-center group hover:shadow-md transition-shadow">
           <h4 className="text-slate-500 mb-2 text-base">クレーム件数</h4>
           <div className="text-5xl font-bold text-slate-700 mb-2">1<span className="text-2xl">件</span></div>
           <p className="text-base text-slate-400">前月比 -1件</p>
        </div>
        <div className="w-1/3 bg-white p-6 rounded-2xl border border-slate-200 shadow-sm text-center group hover:shadow-md transition-shadow">
           <h4 className="text-slate-500 mb-2 text-base">是正処置完了率</h4>
           <div className="text-5xl font-bold text-emerald-600 mb-2">100<span className="text-2xl">%</span></div>
           <p className="text-base text-slate-400">滞留案件なし</p>
        </div>
     </div>

     <div className="bg-white p-6 rounded-2xl border border-slate-200 flex-grow shadow-sm group hover:shadow-md transition-shadow">
        <h3 className="text-xl font-bold text-slate-800 mb-4 border-b pb-2">主な不具合と対策</h3>
        <table className="w-full text-left text-base">
           <thead className="bg-slate-50 text-slate-600">
             <tr>
               <th className="p-3">発生日</th>
               <th className="p-3">内容</th>
               <th className="p-3">原因</th>
               <th className="p-3">対策</th>
               <th className="p-3">ステータス</th>
             </tr>
           </thead>
           <tbody className="divide-y divide-slate-100">
             <tr>
               <td className="p-3">1/12</td>
               <td className="p-3">塗装ムラ発生 (Lot.405)</td>
               <td className="p-3">ノズル詰まり</td>
               <td className="p-3">清掃頻度の見直し(1日2回→4回)</td>
               <td className="p-3"><span className="text-green-600 font-bold bg-green-50 px-2 py-1 rounded">完了</span></td>
             </tr>
             <tr>
               <td className="p-3">1/20</td>
               <td className="p-3">梱包箱の破損</td>
               <td className="p-3">パレット積み過ぎ</td>
               <td className="p-3">積載段数制限の表示徹底</td>
               <td className="p-3"><span className="text-green-600 font-bold bg-green-50 px-2 py-1 rounded">完了</span></td>
             </tr>
           </tbody>
        </table>
     </div>
  </div>
);

// 9. 総合評価 (調整: 文字サイズ・余白縮小)
const SummarySlide = () => (
  <div className="h-full flex flex-col">
    <div className="grid grid-cols-2 gap-8 mb-8">
      <div className="bg-blue-50 p-6 rounded-2xl border border-blue-100 shadow-sm">
        <h3 className="text-xl font-bold text-blue-800 mb-4 flex items-center gap-2">
           <CheckCircle2 size={24}/> 総評: 良好
        </h3>
        <p className="text-slate-800 leading-relaxed text-lg">
          1月度は、年末年始の稼働日減があったものの、事前の増産対応により計画通り推移した。
          特に第1ラインの稼働率が安定しており、全体を牽引した。
          品質面でも大きなトラブルはなく、安定期に入っている。
        </p>
      </div>
      <div className="bg-orange-50 p-6 rounded-2xl border border-orange-100 shadow-sm">
        <h3 className="text-xl font-bold text-orange-800 mb-4 flex items-center gap-2">
           <AlertTriangle size={24}/> 懸念事項・リスク
        </h3>
        <ul className="list-disc pl-5 text-slate-800 space-y-3 text-lg">
           <li>半導体部品の一部で納期遅延の兆候あり。</li>
           <li>来月予定の新製品試作によるライン占有時間の増加。</li>
           <li>インフルエンザ流行による突発的な人員不足リスク。</li>
        </ul>
      </div>
    </div>

    <div className="bg-white p-8 rounded-2xl border border-slate-200 shadow-lg flex-grow flex flex-col justify-center">
      <h3 className="text-2xl font-bold text-slate-800 mb-6 border-b border-slate-100 pb-4">来月へのアクションプラン</h3>
      <div className="grid grid-cols-3 gap-8">
        <div className="group hover:bg-slate-50 p-5 rounded-xl transition-colors">
          <div className="text-sm text-blue-600 font-bold mb-1">ACTION 01</div>
          <div className="font-bold text-xl mb-2 text-slate-800">在庫バッファの確保</div>
          <p className="text-base text-slate-600 leading-relaxed">長納期部品について、1.5ヶ月分の在庫確保を進める。特に海外調達品のリードタイム変動に備える。</p>
        </div>
        <div className="group hover:bg-slate-50 p-5 rounded-xl transition-colors">
          <div className="text-sm text-blue-600 font-bold mb-1">ACTION 02</div>
          <div className="font-bold text-xl mb-2 text-slate-800">多能工化の加速</div>
          <p className="text-base text-slate-600 leading-relaxed">欠勤リスクに備え、主要工程のオペレーターを2名体制へ。スキルマップの更新とOJT計画を実行。</p>
        </div>
        <div className="group hover:bg-slate-50 p-5 rounded-xl transition-colors">
          <div className="text-sm text-blue-600 font-bold mb-1">ACTION 03</div>
          <div className="font-bold text-xl mb-2 text-slate-800">設備メンテナンス</div>
          <p className="text-base text-slate-600 leading-relaxed">週末を利用し、第2ラインの予防保全を実施する。センサー類の交換と給油を重点的に行う。</p>
        </div>
      </div>
    </div>
  </div>
);


// --- メインアプリ ---

function App() {
  const [currentSlide, setCurrentSlide] = useState(0);

  const slides = [
    { component: <CoverSlide />, title: "表紙", subTitle: "" },
    { component: <AgendaSlide />, title: "Agenda", subTitle: "本日の議題" },
    { component: <OrdersSlide />, title: "今月の受注状況", subTitle: "受注・売上・残高" },
    { component: <ProductionSlide />, title: "生産計画 vs 生産実績", subTitle: "予実管理・稼働率" },
    { component: <ProcurementSlide />, title: "部品調達状況", subTitle: "納期・欠品リスク" },
    { component: <PersonnelSlide />, title: "人員状況", subTitle: "稼働・労務管理" },
    { component: <SupplierSlide />, title: "仕入先売上状況", subTitle: "サプライヤー管理" },
    { component: <QualitySlide />, title: "品質実績", subTitle: "品質月報" },
    { component: <SummarySlide />, title: "総合評価", subTitle: "リスクと今後の対策" },
  ];

  const nextSlide = useCallback(() => {
    setCurrentSlide(prev => Math.min(prev + 1, slides.length - 1));
  }, [slides.length]);

  const prevSlide = useCallback(() => {
    setCurrentSlide(prev => Math.max(prev - 1, 0));
  }, []);

  // キーボード操作設定
  useEffect(() => {
    const handleKeyDown = (e) => {
      if (e.key === 'ArrowRight' || e.key === ' ' || e.key === 'Enter') {
        nextSlide();
      } else if (e.key === 'ArrowLeft') {
        prevSlide();
      }
    };
    window.addEventListener('keydown', handleKeyDown);
    return () => window.removeEventListener('keydown', handleKeyDown);
  }, [nextSlide, prevSlide]);

  return (
    <div className="flex flex-col h-screen w-screen bg-black overflow-hidden select-none">
      {/* スライド表示エリア */}
      <div className="flex-grow w-full h-full relative">
        <SlideLayout 
          title={slides[currentSlide].title} 
          subTitle={slides[currentSlide].subTitle}
          slideNumber={currentSlide + 1}
          totalSlides={slides.length}
        >
          {slides[currentSlide].component}
        </SlideLayout>

        {/* ナビゲーションボタン（マウス操作用） */}
        <button 
          onClick={prevSlide}
          disabled={currentSlide === 0}
          className="absolute left-6 top-1/2 -translate-y-1/2 p-4 rounded-full bg-slate-900/5 hover:bg-slate-900/20 text-slate-400 hover:text-slate-800 transition-all disabled:opacity-0 disabled:pointer-events-none z-30"
          aria-label="Previous Slide"
        >
          <ChevronLeft size={40} />
        </button>
        <button 
          onClick={nextSlide}
          disabled={currentSlide === slides.length - 1}
          className="absolute right-6 top-1/2 -translate-y-1/2 p-4 rounded-full bg-slate-900/5 hover:bg-slate-900/20 text-slate-400 hover:text-slate-800 transition-all disabled:opacity-0 disabled:pointer-events-none z-30"
          aria-label="Next Slide"
        >
          <ChevronRight size={40} />
        </button>
      </div>
    </div>
  );
}

const root = createRoot(document.getElementById('root'));
root.render(<App />);
</script>
</body>
</html>